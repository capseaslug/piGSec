# Check if MAC address filtering is enabled.
if mac_address_filtering_checkbox.get():
    mac_address_filtering = True
else:
    mac_address_filtering = False

# Scan for nearby devices.
scan_devices()

# Display the list of nearby devices.
for addr, name, device_class in nearby_devices:
    if mac_address_filtering and not addr in allowed_devices:
        # Block the device from connecting.
        bluetooth.cancel_discovery()
        result_label.config(text="Unauthorized device attempting to connect! MAC address: " + addr)
    else:
        devices_list.insert(tk.END, f"{addr} - {name} - {device_class}")

# Create a button to pair with a selected device.
pair_button = tk.Button(root, text="Pair", command=lambda: secure_pairing(devices_list.get(tk.ANCHOR)))
pair_button.pack()

# Start the main loop.
root.mainloop()
